#!/bin/sh
# $Id$


if [ -d "${DESTDIR}" ] ; then
	if [ "${DISTS}" = "" ] ; then
		exit 2
	fi
	if [ "${SRCDIR}" = "" ] ; then 
		exit 3
		if [ -d "${SRCDIR}" ] ; then

		else
			exit 4
		fi
	fi
	cd ${SRCDIR}
	for distset in ${DISTS}
	do
		if [ -d "${SRCDIR}/${distset}" ] ; then
			cd ${SRCDIR}/${distset}
			for dist in *.aa
			do
				distfile=$(echo ${dist} | cut -d \. -f 1)
				echo -n " * Extracting ${distset}/${distfile} ....."
				case "${distset}" in
					src)
						DESTINATION=${DESTDIR}/usr/src
					;;
					kernels)
						DESTINATION=${DESTDIR}/boot
					;;
					*)
						DESTINATION=${DESTDIR}/
					;;
				esac
				mkdir -p ${DESTINATION}
				if [ "${EXCLUDES}" = "" ] ; then
					cat ${distfile}.?? | gunzip | tar -xpf - -C ${DESTINATION}
				else
					cat ${distfile}.?? | gunzip | tar -xpf - --exclude "${EXCLUDES}" -C ${DESTINATION}
				fi
				echo " [DONE]"
			done
		else
			exit 5
		fi
	done
else
	exit 1
fi
